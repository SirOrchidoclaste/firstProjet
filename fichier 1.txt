Version 2 solution